Job started at Sun Apr 20 16:43:50 CDT 2025
Running on g033.grace.hprc.tamu.edu
Sun Apr 20 16:43:50 2025       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.230.02             Driver Version: 535.230.02   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-PCIE-40GB          On  | 00000000:3B:00.0 Off |                  Off |
| N/A   17C    P0              30W / 250W |      0MiB / 40960MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
Generating RL training data...
INFO:get_data:Using data from data/train.txt
Vocab size: 6969
Tokenizing data file...
33315753 tokens created from the file. Each epoch will have 520558 batches.
Number of trainable parameters in the model: 30932569
Number of tokens per parameters: 1.0770.
Traceback (most recent call last):
  File "/scratch/user/sarveshgs22/AdaptiveEvictLLMfScratch/generate_rl_data.py", line 72, in <module>
    main(args)
    ~~~~^^^^^^
  File "/scratch/user/sarveshgs22/AdaptiveEvictLLMfScratch/generate_rl_data.py", line 30, in main
    prompts = generate_conversation_prompts(
        solver,
    ...<2 lines>...
        max_length=args.max_length
    )
  File "/scratch/user/sarveshgs22/AdaptiveEvictLLMfScratch/generate_rl_data.py", line 16, in generate_conversation_prompts
    generated_text = solver.generate_text(
        input_text=base_prompt,
        n_tokens_to_generate=torch.randint(min_length, max_length, (1,)).item(),
        kv_cache=True
    )
  File "/scratch/user/sarveshgs22/AdaptiveEvictLLMfScratch/solver.py", line 125, in generate_text
    probs = F.softmax(next_token_logits/(self.args.temperature + 1e-8), -1)
                                         ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Namespace' object has no attribute 'temperature'
Training RL agent...
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: sarveshgs22tamu (sarveshgs22tamu-texas-a-m-university) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.9
wandb: Run data is saved locally in /scratch/user/sarveshgs22/AdaptiveEvictLLMfScratch/wandb/run-20250420_164810-72h0r9md
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run efficient-pyramid-4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sarveshgs22tamu-texas-a-m-university/adaptive-kv-cache
wandb: üöÄ View run at https://wandb.ai/sarveshgs22tamu-texas-a-m-university/adaptive-kv-cache/runs/72h0r9md
Traceback (most recent call last):
  File "/scratch/user/sarveshgs22/AdaptiveEvictLLMfScratch/train_rl_agent.py", line 160, in <module>
    train(args)
    ~~~~~^^^^^^
  File "/scratch/user/sarveshgs22/AdaptiveEvictLLMfScratch/train_rl_agent.py", line 24, in train
    training_data = load_training_data(args.training_data_path)
  File "/scratch/user/sarveshgs22/AdaptiveEvictLLMfScratch/train_rl_agent.py", line 13, in load_training_data
    with open(data_path, 'r') as f:
         ~~~~^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'data/rl_training_data.json'
[1;34mwandb[0m: 
[1;34mwandb[0m: üöÄ View run [33mefficient-pyramid-4[0m at: [34mhttps://wandb.ai/sarveshgs22tamu-texas-a-m-university/adaptive-kv-cache/runs/72h0r9md[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250420_164810-72h0r9md/logs[0m
Job finished at Sun Apr 20 16:48:14 CDT 2025
